<!DOCTYPE html>
<html>

<head>
    <title>Shopping here</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>
        body {
            background-color: #b65fcf;
            font-family: cursive;
            color: hotpink;
        }

        .container {
            background-color: #fff;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>

<body>
  
  
<div class="container mt-5">
    <h1 class="mb-4">Register Now</h1>
    <form action="/" method="POST" id="appointmentForm">
        <div class="row">
            <div class="col-md-6 pb-4">
                <label for="pname" class="form-label"> Name</label>
                <input type="text" name="name"  class="form-control" id="pname">
            </div>
            <div class="col-md-6 pb-4">
                <label for="Size" class="form-label">Size</label>
                <input type="number" name="Size"  class="form-control" id="Size">
            </div>
        </div>
        <div class="row">
            <div class="col-md-6 pb-4">
                <label for="gender" class="form-label">Gender</label>
                <select class="form-select" id="gender">
                    <option value="">Select Gender</option>
                    <option value="male">Male</option>
                    <option value="female">Female</option>
                    <option value="other">Unisex</option>
                </select>
            </div>
            <div class="col-md-6 pb-4">
                <label for="Brand" class="form-label">Brand</label>
                <input type="text" name="Brand"  class="form-control" id="Brand">
            </div>
        </div>
        <div class="row">
            <div class="col-md-6 pb-4">
                <label for="Outfits" class="form-label">Outfits</label>
                <select class="form-select" id="Outfits">
                    <option value="">choose Your Outfits</option>
                    <option value="Jeans">Jeans</option>
                    <option value="Hoodies">Hoodies</option>
                    <option value="Jackets">Jackets</option>
                </select>
            </div>
            <div class="col-md-6 pb-4">
                <label for="email" class="form-label">Email</label>
                <input type="email" name="email"  class="form-control" id="email">
            </div>
        </div>
        <div class="row">
            <div class="col-md-6 pb-4">
                <label for="phoneNumber" class="form-label">Phone Number</label>
                <input type="tel" name="phonenum"  class="form-control" id="phoneNumber">
            </div>
            <div class="col-md-6 pb-4">
                <label for="AppointmentDateTime" class="form-label">Date And Time</label>
                <input type="datetime-local" class="form-control" id="AppointmentDateTime">
            </div>
        </div>
        <div class="d-flex justify-content-end mt-3 pb-4">
            <button type="submit" id="sub" class="btn btn-info">Submit</button>
        </div>
    </form>
</div>


    <script src="data"></script>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const form = document.getElementById("appointmentForm");
            form.addEventListener("submit", async function (event) {
            event.preventDefault()
                formValid()
                const data = { 
                    pname: document.getElementById("pname").value,
                    Size: document.getElementById("Size").value,
                    Gender: document.getElementById("gender").value,
                    Brand: document.getElementById("Brand").value,
                    Outfits: document.getElementById("Outfits").value,
                    Email: document.getElementById("email").value,
                    PhoneNumber: document.getElementById("phoneNumber").value,
                    AppointmentDateTime: document.getElementById("AppointmentDateTime").value
                };
                const jsonData = JSON.stringify(data);

                if (jsonData.trim() !== '') {

                    fetch('/', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: jsonData
                    })

                        .then(response => {
                            if (response.ok) {
                                window.location.href = "/"
                            } else {
                                                                                                                                                                                                                                                                                
                                console.error('Error sending data to server');
                            }
                        })
                        .catch(error => {
                            console.error('An error occurred:', error);
                        });
                } else {
                    console.error('JSON data is empty');
                }


                if (jsonData.trim() !== '') {
                    // send JSON data to the server using the fetch API
                    fetch('/', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json' // set correctly
                        },
                        body: JSON.stringify(formData)
                    })
                        .then(response => {
                            if (response.ok) {
                                // data sent to the server
                                console.log('Data sent successfully');
                            } else {
                                // handle HTTP error responses
                                console.error('Error sending data to server');
                            }
                        })
                        .catch(error => {
                            // handle network or other errors
                            console.error('An error occurred:', error);
                        });
                } else {
                    console.error('JSON data is empty');
                }
            });
        });
    </script>


<script>
    function formValid(){
        const phoneNumber = document.getElementById('phoneNumber').value;
        const email = document.getElementById('email').value;
        const Outfits = document.getElementById('Outfits').value
        const Size = parseInt(document.getElementById('Size').value);
        // const Outfits = document.getElementById('Outfits').value;
        const gender = document.getElementById('gender').value
        const AppointmentDateTime = document.getElementById('AppointmentDateTime').value
        let errorMessSize = '';
      
        if (!/^\d{10}$/.test(phoneNumber)) {
            errorMessSize += 'Please enter a valid phone number (up to 10 digits).\n';
        }
        
        if (!/^[\w-]+(\.[\w-]+)*@([\w-]+\.)+[a-zA-Z]{2,7}$/.test(email)) {
            errorMessSize += 'Please enter a valid email address.\n';
        }

        if(Outfits==""){
            errorMessSize+="choose any one"
        }

        if (isNaN(Size) || Size <= 0 || Size > 100) {
            errorMessSize += 'Please enter a valid Size between 1 and 100';
        }

        if(gender==""){
            errorMessSize+="please select one"
        }

        if(Outfits==""){
            errorMessSize="choose anyone"
        }

        if(AppointmentDateTime==""){
            errorMessSize="enter date"
        }
       
        if (errorMessSize) {
            alert(errorMessSize);
            e.preventDefault();
            return false;
        }
       
    }
</script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>